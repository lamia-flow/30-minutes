(window["webpackJsonp30-minutes"]=window["webpackJsonp30-minutes"]||[]).push([[0],{32:function(t,n,e){t.exports=e.p+"static/media/citybike.36bcc6d2.svg"},46:function(t,n,e){t.exports=e.p+"static/media/youarehere.eb9a9cc8.svg"},54:function(t,n,e){t.exports=e(85)},59:function(t,n,e){},60:function(t,n,e){},62:function(t,n,e){t.exports=e.p+"static/media/notgonnamakeit.cb5634bc.svg"},85:function(t,n,e){"use strict";e.r(n);var a=e(2),i=e.n(a),o=e(24),r=e.n(o),s=(e(59),e(19)),l=e(17),c=e(22),u=e(20),p=e(23),h=(e(60),e(45)),m=e(34),d=e(31),f=(e(61),e(87)),v=e(91),g=e(90),b=e(89),y=e(88),E=e(6),k=e.n(E),w=e(46),O=e.n(w);function j(){var t=Object(h.a)(['\n  {\n    plan(\n      fromPlace: "',",",'"\n      toPlace: "',",",'"\n      numItineraries: 1\n      transportModes: [{ mode: BICYCLE, qualifier: RENT }, { mode: WALK }]\n    ) {\n      itineraries {\n        walkDistance\n        duration\n        legs {\n          mode\n          startTime\n          endTime\n          from {\n            lat\n            lon\n            name\n            bikeRentalStation {\n              stationId\n              name\n            }\n          }\n          to {\n            lat\n            lon\n            name\n            bikeRentalStation {\n              stationId\n              name\n            }\n          }\n          distance\n          legGeometry {\n            length\n            points\n          }\n        }\n      }\n    }\n  }\n']);return j=function(){return t},t}var A=new k.a.Icon({iconUrl:e(32),iconRetinaUrl:e(32),iconAnchor:[5,55],popupAnchor:[10,-44],iconSize:[25,45]}),C=new k.a.Icon({iconUrl:e(32),iconRetinaUrl:e(62),iconAnchor:[5,55],popupAnchor:[10,-44],iconSize:[25,45]}),S=function(t){var n=t.station,e=t.position,a=n.isInside?A:C,o=Object(d.b)(j(),e[0],e[1],n.y,n.x),r=Object(m.a)(o).data;r&&console.log(r);var s=r&&r.plan.itineraries[0]&&r.plan.itineraries[0].duration,l=r&&r.plan.itineraries[0]&&r.plan.itineraries[0].walkDistance;return s/60<30?i.a.createElement(f.a,{position:[n.y,n.x],icon:a},i.a.createElement(v.a,null,i.a.createElement("div",null,n.name),i.a.createElement("div",null,"Num. of Bikes: ",n.bikesAvailable),i.a.createElement("div",null,"Duration: ",s),i.a.createElement("div",null,"Distance: ",l))):i.a.createElement(f.a,{position:[n.y,n.x],icon:a},i.a.createElement(v.a,null,i.a.createElement("div",null,"TOO FAR : ",n.name),i.a.createElement("div",null,"Num. of Bikes: ",n.bikesAvailable),i.a.createElement("div",null,"Duration: ",s),i.a.createElement("div",null,"Distance: ",l)))},x=function(t){function n(){return Object(s.a)(this,n),Object(c.a)(this,Object(u.a)(n).apply(this,arguments))}return Object(p.a)(n,t),Object(l.a)(n,[{key:"componentDidUpdate",value:function(t,n){if(t.stations!==this.props.stations)return!0}},{key:"shouldComponentUpdate",value:function(t,n){if(t.stations!==this.props.stations)return!0}},{key:"render",value:function(){var t=this;if(this.props.stations&&this.props.stations.length>0){var n=this.props.stations.map((function(n){return i.a.createElement(S,{key:n.id,station:n,position:t.props.position})}));return i.a.createElement(a.Fragment,null,n)}return i.a.createElement("div",null,"Empty")}}]),n}(i.a.Component),D=function(t){function n(){var t,e;Object(s.a)(this,n);for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return(e=Object(c.a)(this,(t=Object(u.a)(n)).call.apply(t,[this].concat(i)))).stationsInsideCircle=function(t,n){var e=new k.a.latLng(n);return t.filter((function(t){return e.distanceTo([t.y,t.x])<6e3}))},e}return Object(p.a)(n,t),Object(l.a)(n,[{key:"componentDidUpdate",value:function(t,n){if(t.lat!==this.props.lat||t.lng!==this.props.lng||t.stations!==this.props.stations)return!0}},{key:"shouldComponentUpdate",value:function(t,n){if(t.lat!==this.props.lat||t.lng!==this.props.lng||t.stations!==this.props.stations)return!0}},{key:"insideCircle",value:function(t,n,e,a,i){return Math.sqrt(t-e)+Math.sqrt(n-a)<=Math.sqrt(i)}},{key:"render",value:function(){var t=k.a.icon({iconUrl:O.a,iconSize:[35,35],iconAnchor:[15.5,15.5],popupAnchor:[-3,-26],shadowSize:[20,20],shadowAnchor:[22,24]}),n=[this.props.lat,this.props.lng],e=this.props.stations;return console.log(e),i.a.createElement(g.a,{center:n,zoom:11,style:{height:"100vh",width:"100vw"}},i.a.createElement(b.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://cdn.digitransit.fi/map/v1/hsl-map-256/{z}/{x}/{y}.png"}),this.props.stations&&e&&i.a.createElement(x,{stations:this.stationsInsideCircle(e,n),position:n}),i.a.createElement(f.a,{position:n,icon:t},i.a.createElement(v.a,null,"You are here")),i.a.createElement(y.a,{center:n,radius:6e3}))}}]),n}(i.a.Component),I=e(53),U=e.n(I),z=e(12),L=new d.a({uri:"https://api.digitransit.fi/routing/v1/routers/hsl/index/graphql"}),M=function(t){function n(t){var e;return Object(s.a)(this,n),(e=Object(c.a)(this,Object(u.a)(n).call(this,t))).getStationList=function(){U.a.get("https://api.digitransit.fi/routing/v1/routers/hsl/bike_rental",{headers:{"Content-Type":"application/json"}}).then((function(t){e.setState({stations:t.data.stations})})).catch((function(){console.log("Failed to fetch the stations")}))},e.state={lat:null,lng:null,zoom:13,stations:null},e}return Object(p.a)(n,t),Object(l.a)(n,[{key:"componentDidMount",value:function(){var t=this;navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(n){var e=n.coords;console.log(e),t.setState({lat:e.latitude,lng:e.longitude})})),this.getStationList()}},{key:"componentDidUpdate",value:function(t,n){if(n.lat!==this.state.lat||n.lng!==this.state.lng||n.stations!==this.state.stations)return!0}},{key:"render",value:function(){var t=this.state,n=t.lat,e=t.lng,a=t.stations;return n&&e&&a?i.a.createElement(z.a,{client:L},i.a.createElement(D,{lat:n,lng:e,stations:a,key:a})):i.a.createElement("div",null,"Loading...")}}]),n}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[54,1,2]]]);
//# sourceMappingURL=main.6a4a41ad.chunk.js.map